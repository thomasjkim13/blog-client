{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useLocation}from\"react-router\";import{Link}from\"react-router-dom\";import axios from\"axios\";import\"./postshow.css\";import{Context}from\"../../context/Context\";import{useContext}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PostShow(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var Folder=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),update=_useState8[0],setUpdate=_useState8[1];useEffect(function(){// create getPost function, async\nvar getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;// setPost to use post in useState\nsetPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();// whenever path changes, fire useEffect\n},[path]);// delete function to delete owners post\nvar handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:// when deleted, direct to this link\nwindow.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();// function to update post information\nvar handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{// update these properties\nusername:user.username,title:title,desc:desc});case 3:setUpdate(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"postShow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"postShowWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{className:\"postShowImg\"// use image from the image folder stored locally to keep it default\n,src:Folder+post.photo,alt:\"\"}),update?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"postShowTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"postShowTitle\",children:[title,post.username===user.username&&/*#__PURE__*/_jsxs(\"div\",{className:\"postShowEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"postShowIcon far fa-edit\",onClick:function onClick(){return setUpdate(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"postShowIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postShowInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"postShowAuthor\",children:[\"Author :\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"postShowDate\",children:new Date(post.createdAt).toDateString()})]}),update?/*#__PURE__*/_jsx(\"textarea\",{className:\"postShowDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"postShowDesc\",children:desc}),update&&/*#__PURE__*/_jsx(\"button\",{className:\"postShowButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"sources":["/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/src/components/PostShow/PostShow.jsx"],"names":["useEffect","useState","useLocation","Link","axios","Context","useContext","PostShow","location","path","pathname","split","post","setPost","Folder","user","title","setTitle","desc","setDesc","update","setUpdate","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\"\nimport { useLocation } from \"react-router\"\nimport { Link } from \"react-router-dom\"\nimport axios from \"axios\"\nimport \"./postshow.css\"\nimport { Context } from \"../../context/Context\"\nimport { useContext } from \"react\"\n\nexport default function PostShow() {\n  const location = useLocation()\n  const path = location.pathname.split(\"/\")[2]\n  const [post, setPost] = useState({})\n  const Folder = \"http://localhost:5000/images/\"\n  const {user} = useContext(Context)\n  const [title, setTitle] = useState(\"\")\n  const [desc, setDesc] = useState(\"\")\n  const [update, setUpdate] = useState(false)\n\n  useEffect(() => {\n    // create getPost function, async\n    const getPost = async () => {\n      // axios get signle post\n      const res = await axios.get(\"/posts/\" + path)\n      // setPost to use post in useState\n      setPost(res.data)\n      setTitle(res.data.title)\n      setDesc(res.data.desc)\n    }\n    getPost()\n    // whenever path changes, fire useEffect\n  }, [path])\n  \n  // delete function to delete owners post\n  const handleDelete = async () => {\n    try {\n      await axios.delete(`/posts/${post._id}`, { data: { username:user.username },})\n      // when deleted, direct to this link\n      window.location.replace(\"/\")\n    } catch (err) {}\n  }\n  \n  // function to update post information\n  const handleUpdate = async () => {\n    try {\n      await axios.put(`/posts/${post._id}`, { \n        // update these properties\n        username:user.username, \n        title, \n        desc \n      })\n      setUpdate(false)\n    } catch (err) {}\n  }\n\n  return (\n    <div className=\"postShow\">\n      <div className=\"postShowWrapper\">\n        {post.photo && (\n          <img className=\"postShowImg\" \n          // use image from the image folder stored locally to keep it default\n          src={Folder + post.photo}\n          alt=\"\" />\n        )}{\n          update ? (\n            <input \n            type=\"text\" \n            value={title} \n            className=\"postShowTitleInput\" \n            autoFocus \n            onChange={(e) => setTitle(e.target.value)}\n            /> \n            ) : (\n            <h1 className=\"postShowTitle\">\n              {title}\n              {post.username === user.username && (\n                <div className=\"postShowEdit\">\n                  <i className=\"postShowIcon far fa-edit\" onClick={() => setUpdate(true)}></i>\n                  <i className=\"postShowIcon far fa-trash-alt\" onClick={handleDelete}></i>\n                </div>\n              )}\n            </h1>\n          )\n        }\n        <div className=\"postShowInfo\">\n          <span className=\"postShowAuthor\">Author : \n          <Link to ={`/?user=${post.username}`} className=\"link\">\n            <b>{post.username}</b>\n          </Link>\n          </span>\n          <span className=\"postShowDate\">{new Date(post.createdAt).toDateString()}</span>\n        </div>\n        {update ? (\n          <textarea className=\"postShowDescInput\" value={desc} onChange={(e) => setDesc(e.target.value)} />\n        ) : (\n          <p className=\"postShowDesc\">{desc}</p>\n        )}\n        {update && (\n        <button className=\"postShowButton\" onClick={handleUpdate}>Update</button>\n        )}\n      </div>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}