{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useContext}from\"react\";import\"./publish.css\";import axios from\"axios\";import{Context}from\"../../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Publish(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"publish\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"publishImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"publishForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"publishFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"publishIcon fas fa-folder-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"publishInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"publishFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"publishInput publishText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"publishBtn\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"sources":["/Users/thomaskim/Desktop/sei/projects/capstone_project/blog-client/src/components/Links/Publish/Publish.jsx"],"names":["useState","useContext","axios","Context","Publish","title","setTitle","desc","setDesc","file","setFile","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"mappings":"4bAAA,OAASA,QAAT,CAAmBC,UAAnB,KAAqC,OAArC,CACA,MAAO,eAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,0BAAxB,C,wFAEA,cAAe,SAASC,CAAAA,OAAT,EAAmB,CAChC,cAA0BJ,QAAQ,CAAC,EAAD,CAAlC,wCAAOK,KAAP,eAAcC,QAAd,eACA,eAAwBN,QAAQ,CAAC,EAAD,CAAhC,yCAAOO,IAAP,eAAaC,OAAb,eACA,eAAwBR,QAAQ,CAAC,IAAD,CAAhC,yCAAOS,IAAP,eAAaC,OAAb,eACA,gBAAeT,UAAU,CAACE,OAAD,CAAzB,CAAOQ,IAAP,aAAOA,IAAP,CAEA,GAAMC,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,gJACnBA,CAAC,CAACC,cAAF,GACMC,OAFa,CAEH,CACdC,QAAQ,CAACL,IAAI,CAACK,QADA,CAEdX,KAAK,CAALA,KAFc,CAGdE,IAAI,CAAJA,IAHc,CAFG,KAOhBE,IAPgB,0BAQXQ,IARW,CAQJ,GAAIC,CAAAA,QAAJ,EARI,CASXC,QATW,CASAC,IAAI,CAACC,GAAL,GAAaZ,IAAI,CAACa,IATlB,CAUjBL,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBJ,QAApB,EACAF,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBd,IAApB,EACAM,OAAO,CAACS,KAAR,CAAgBL,QAAhB,CAZiB,uCAcTjB,CAAAA,KAAK,CAACuB,IAAN,CAAW,SAAX,CAAsBR,IAAtB,CAdS,0IAkBCf,CAAAA,KAAK,CAACuB,IAAN,CAAW,QAAX,CAAqBV,OAArB,CAlBD,SAkBXW,GAlBW,eAmBjBC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,SAAWH,GAAG,CAACT,IAAJ,CAASa,GAA5C,EAnBiB,+JAAH,kBAAZlB,CAAAA,YAAY,4CAAlB,CAuBA,mBACE,aAAK,SAAS,CAAC,SAAf,WACGH,IAAI,eACH,YAAK,SAAS,CAAC,YAAf,CACE,GAAG,CAAEsB,GAAG,CAACC,eAAJ,CAAoBvB,IAApB,CADP,CAEE,GAAG,CAAC,EAFN,EAFJ,cAOE,cAAM,SAAS,CAAC,aAAhB,CAA8B,QAAQ,CAAIG,YAA1C,wBACE,aAAK,SAAS,CAAC,kBAAf,wBAEE,cAAO,OAAO,CAAC,WAAf,uBACE,UAAG,SAAS,CAAC,gCAAb,EADF,EAFF,cAKE,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,WAFL,CAGE,KAAK,CAAE,CAACqB,OAAO,CAAC,MAAT,CAHT,CAIE,QAAQ,CAAE,kBAACpB,CAAD,QAAOH,CAAAA,OAAO,CAACG,CAAC,CAACqB,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAd,EAJZ,EALF,cAYE,cACE,IAAI,CAAC,MADP,CAEE,WAAW,CAAC,OAFd,CAGE,SAAS,CAAC,cAHZ,CAIE,SAAS,CAAE,IAJb,CAKE,QAAQ,CAAE,kBAACtB,CAAD,QAAOP,CAAAA,QAAQ,CAACO,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAf,EALZ,EAZF,GADF,cAqBE,YAAK,SAAS,CAAC,kBAAf,uBACE,iBACE,WAAW,CAAC,oBADd,CAEE,IAAI,CAAC,MAFP,CAGE,SAAS,CAAC,0BAHZ,CAIE,QAAQ,CAAE,kBAACvB,CAAD,QAAOL,CAAAA,OAAO,CAACK,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAd,EAJZ,EADF,EArBF,cA6BE,eAAQ,SAAS,CAAC,YAAlB,CAA+B,IAAI,CAAC,QAApC,qBA7BF,GAPF,GADF,CAyCD","sourcesContent":["import { useState, useContext } from \"react\"\nimport \"./publish.css\"\nimport axios from \"axios\"\nimport { Context } from \"../../../context/Context\"\n\nexport default function Publish() {\n  const [title, setTitle] = useState(\"\")\n  const [desc, setDesc] = useState(\"\")\n  const [file, setFile] = useState(null)\n  const {user} = useContext(Context)\n\n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    const newPost = {\n      username:user.username,\n      title,\n      desc\n    }\n    if(file) {\n      const data = new FormData()\n      const filename = Date.now() + file.name\n      data.append(\"name\", filename)\n      data.append(\"file\", file)\n      newPost.photo = filename;\n      try {\n        await axios.post(\"/upload\", data) \n      } catch (err) {}\n    }\n    try {\n      const res = await axios.post(\"/posts\", newPost)\n      window.location.replace(\"/post/\" + res.data._id)\n    } catch (err) {}\n  }\n\n  return (\n    <div className=\"publish\">\n      {file && (\n        <img className=\"publishImg\"\n          src={URL.createObjectURL(file)}\n          alt=\"\"\n        />\n      )}\n      <form className=\"publishForm\" onSubmit = {handleSubmit}>\n        <div className=\"publishFormGroup\">\n          {/* links to id=\"fileInput\" */}\n          <label htmlFor=\"fileInput\">\n            <i className=\"publishIcon fas fa-folder-plus\"></i>\n          </label>\n          <input \n            type=\"file\" \n            id=\"fileInput\" \n            style={{display:\"none\"}} \n            onChange={(e) => setFile(e.target.files[0])}\n          />\n          {/* autoFocus automatically focuses on the text input */}\n          <input \n            type=\"text\" \n            placeholder=\"Title\" \n            className=\"publishInput\" \n            autoFocus={true} \n            onChange={(e) => setTitle(e.target.value)}\n          />\n        </div>\n        <div className=\"publishFormGroup\">\n          <textarea \n            placeholder=\"Tell your story...\" \n            type=\"text\" \n            className=\"publishInput publishText\" \n            onChange={(e) => setDesc(e.target.value)}>\n          </textarea>\n        </div>\n        <button className=\"publishBtn\" type=\"submit\">Publish</button>\n      </form>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}